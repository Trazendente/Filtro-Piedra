<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Filtro Piedra</title>
    <style>
      #controls button {
        background: none;
        border: none;
        padding: 0;
        cursor: pointer;
      }
      #controls button img {
        width: 50px; /* Ajusta el tamaño de las imágenes como desees */
        height: auto;
      }
    </style>
    <script type="module" crossorigin src="/Filtro-Piedra/assets/index-ehlmbuJG.js"></script>
  </head>
  <body>
    <canvas id="canvas"></canvas>
    <div id="controls">
      <button id="capturePhoto">
        <img src="https://cdn.glitch.global/cba16981-afa0-49c7-9521-0c5f904a2f33/camarav2.png?v=1726788936473" alt="Capture Photo">
      </button>
      <button id="startRecordingButton">
        <img src="https://cdn.glitch.global/40cefa43-2503-411d-9aaf-d230f3ac7843/recordingv2.png?v=1726858940288" alt="Start Recording">
      </button>
      <button id="stopRecordingButton" style="display:none;">
        <img src="https://cdn.glitch.global/40cefa43-2503-411d-9aaf-d230f3ac7843/stop.png?v=1726858129411" alt="Stop Recording">
      </button>
    </div>
    <script>
      const startRecordingButton = document.getElementById('startRecordingButton');
      const stopRecordingButton = document.getElementById('stopRecordingButton');
      let isRecording = false;
      let mediaRecorder;
      let recordedChunks = [];

      // Función para iniciar la grabación
      function startRecording() {
        const stream = canvas.captureStream(30);
        mediaRecorder = new MediaRecorder(stream);

        mediaRecorder.ondataavailable = (event) => {
          recordedChunks.push(event.data);
        };

        mediaRecorder.onstop = () => {
          const blob = new Blob(recordedChunks, { type: 'video/webm' });
          const url = URL.createObjectURL(blob);
          const link = document.createElement('a');
          link.href = url;
          link.download = 'recording.webm';
          link.click();
          recordedChunks = [];
        };

        mediaRecorder.start();
        isRecording = true;

        // Alternar visibilidad de botones
        startRecordingButton.style.display = 'none';
        stopRecordingButton.style.display = 'inline-block';
      }

      // Función para detener la grabación
      function stopRecording() {
        if (mediaRecorder && mediaRecorder.state !== 'inactive') {
          mediaRecorder.stop();
        }
        isRecording = false;

        // Alternar visibilidad de botones
        stopRecordingButton.style.display = 'none';
        startRecordingButton.style.display = 'inline-block';
      }

      // Eventos para los botones
      startRecordingButton.addEventListener('click', startRecording);
      stopRecordingButton.addEventListener('click', stopRecording);
    </script>
  </body>
</html>
